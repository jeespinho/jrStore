<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <title>JRStore - Moda e Estilo</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <!-- Header -->
    <header>
      <div class="container header-content">
        <a href="index.html" class="logo">JR<span>Store</span></a>
        
        <!-- Menu Mobile Toggle -->
        <button class="mobile-menu-toggle" id="mobile-menu-toggle">
          <span></span>
          <span></span>
          <span></span>
        </button>

        <!-- Navega√ß√£o -->
        <nav class="main-nav" id="main-nav">
          <ul>
            <li><a href="#produtos" class="nav-link">In√≠cio</a></li>
            <li><a href="#masculino" class="nav-link">Masculino</a></li>
            <li><a href="#feminino" class="nav-link">Feminino</a></li>
            <li><a href="#infantil" class="nav-link">Infantil</a></li>
            <li><a href="#ofertas" class="nav-link">Ofertas</a></li>
          </ul>
        </nav>

        <div class="search-cart">
          <div class="search-box">
            <input type="text" id="search-input" placeholder="Buscar produtos..." />
            <button id="search-button">üîç</button>
          </div>
          <a href="carrinho.html" class="cart-icon">
            üõí <span class="cart-count">0</span>
          </a>

          <!-- Bot√£o de Login (aparece quando usu√°rio n√£o est√° logado) -->
          <a href="login.html" id="header-login-btn" class="login-button"
            >Entrar</a
          >

          <!-- Menu do Usu√°rio (aparece quando usu√°rio est√° logado) -->
          <div id="user-menu" class="user-menu" style="display: none">
            <div class="user-info">
              <span class="user-greeting"
                >Ol√°, <span id="user-name">Usu√°rio</span>!</span
              >
              <div class="user-dropdown">
                <a href="perfil.html" class="user-menu-item">üë§ Meu Perfil</a>
                <a href="pedidos.html" class="user-menu-item"
                  >üì¶ Meus Pedidos</a
                >
                <button id="logout-btn" class="user-menu-item">üö™ Sair</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Banner Principal -->
    <section class="hero">
      <div class="container">
        <h1>Moda com Estilo e Qualidade</h1>
        <p>
          Descubra as √∫ltimas tend√™ncias em moda com pre√ßos incr√≠veis. Entrega
          r√°pida para todo o Brasil.
        </p>
        <a href="#produtos" class="btn">Ver Ofertas</a>
      </div>
    </section>

    <!-- Conte√∫do Principal -->
    <main class="container">
      <!-- Filtros e Categorias -->
      <section class="filters">
        <div class="categories" id="categories-container">
          <!-- As categorias ser√£o carregadas dinamicamente aqui -->
        </div>
        <div class="sort-options">
          <select id="sort-by">
            <option value="name">Ordenar por: Nome</option>
            <option value="price-low">Ordenar por: Pre√ßo (menor)</option>
            <option value="price-high">Ordenar por: Pre√ßo (maior)</option>
          </select>
        </div>
      </section>

      <!-- Grid de Produtos -->
      <section class="products-section" id="produtos">
        <div class="loading" id="loading">Carregando produtos...</div>
        <div class="products-grid" id="products-grid"></div>
      </section>
    </main>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="footer-content">
          <div class="footer-column">
            <h3>JRStore</h3>
            <p>Moda com estilo e qualidade para todos os gostos.</p>
          </div>
          <div class="footer-column">
            <h3>Links R√°pidos</h3>
            <ul>
              <li><a href="#produtos">In√≠cio</a></li>
              <li><a href="sobre.html">Sobre N√≥s</a></li>
              <li><a href="contato.html">Contato</a></li>
            </ul>
          </div>
          <div class="footer-column">
            <h3>Categorias</h3>
            <ul id="footer-categories">
              <!-- Categorias ser√£o carregadas dinamicamente aqui -->
            </ul>
          </div>
          <div class="footer-column newsletter">
            <h3>Newsletter</h3>
            <input type="email" placeholder="Seu e-mail" />
            <button class="btn">Inscrever</button>
          </div>
        </div>
        <div class="copyright">
          &copy; 2023 JRStore. Todos os direitos reservados.
        </div>
      </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/products.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/main.js"></script>

    <script>
      // Carrinho functions
      function getCart() {
        return JSON.parse(localStorage.getItem("cart")) || [];
      }

      function updateCartCount() {
        const cart = getCart();
        const total = cart.reduce((sum, item) => sum + item.quantity, 0);
        document.querySelector(".cart-count").textContent = total;
      }

      function addToCart(product) {
        const cart = getCart();
        const existingItem = cart.find((item) => item.id === product.id);

        if (existingItem) {
          existingItem.quantity += 1;
        } else {
          cart.push({ ...product, quantity: 1 });
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartCount();
        alert("Produto adicionado ao carrinho!");
      }

      // Menu Mobile
      document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const mainNav = document.getElementById('main-nav');
        
        if (mobileMenuToggle && mainNav) {
          mobileMenuToggle.addEventListener('click', function() {
            mainNav.classList.toggle('active');
            mobileMenuToggle.classList.toggle('active');
          });

          // Fechar menu ao clicar em um link
          const navLinks = mainNav.querySelectorAll('a');
          navLinks.forEach(link => {
            link.addEventListener('click', function() {
              mainNav.classList.remove('active');
              mobileMenuToggle.classList.remove('active');
            });
          });

          // Fechar menu ao clicar fora
          document.addEventListener('click', function(e) {
            if (!mainNav.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
              mainNav.classList.remove('active');
              mobileMenuToggle.classList.remove('active');
            }
          });
        }
      });

      // Implementa√ß√£o das novas funcionalidades
      document.addEventListener('DOMContentLoaded', function() {
        // 1. Barra de pesquisa funcional
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        
        function performSearch() {
          const searchTerm = searchInput.value.trim();
          if (searchTerm) {
            // Aqui voc√™ implementaria a l√≥gica de busca
            // Por enquanto, vamos apenas filtrar os produtos vis√≠veis
            filterProductsBySearch(searchTerm);
          } else {
            // Se a pesquisa estiver vazia, mostrar todos os produtos
            showAllProducts();
          }
        }
        
        searchButton.addEventListener('click', performSearch);
        searchInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            performSearch();
          }
        });
        
        // 2. Navega√ß√£o por √¢ncoras
        const navLinks = document.querySelectorAll('.nav-link');
        navLinks.forEach(link => {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);
            
            if (targetElement) {
              // Rolagem suave para a se√ß√£o
              targetElement.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
              });
            }
          });
        });
        
        // 3. Carregar categorias do banco de dados
        loadCategoriesFromDatabase();
        
        // 4. Carregar produtos do banco de dados
        loadProductsFromDatabase();
      });
      
      // Fun√ß√£o para filtrar produtos por pesquisa
      function filterProductsBySearch(searchTerm) {
        const products = document.querySelectorAll('.product-card');
        let foundProducts = false;
        
        products.forEach(product => {
          const productName = product.querySelector('.product-name').textContent.toLowerCase();
          const productDescription = product.querySelector('.product-description').textContent.toLowerCase();
          const searchTermLower = searchTerm.toLowerCase();
          
          if (productName.includes(searchTermLower) || productDescription.includes(searchTermLower)) {
            product.style.display = 'block';
            foundProducts = true;
          } else {
            product.style.display = 'none';
          }
        });
        
        // Mostrar mensagem se nenhum produto for encontrado
        const productsGrid = document.getElementById('products-grid');
        let noResultsMessage = document.getElementById('no-results-message');
        
        if (!foundProducts) {
          if (!noResultsMessage) {
            noResultsMessage = document.createElement('div');
            noResultsMessage.id = 'no-results-message';
            noResultsMessage.className = 'no-results';
            noResultsMessage.textContent = 'Nenhum produto encontrado para sua pesquisa.';
            productsGrid.appendChild(noResultsMessage);
          }
        } else if (noResultsMessage) {
          noResultsMessage.remove();
        }
      }
      
      // Fun√ß√£o para mostrar todos os produtos
      function showAllProducts() {
        const products = document.querySelectorAll('.product-card');
        products.forEach(product => {
          product.style.display = 'block';
        });
        
        const noResultsMessage = document.getElementById('no-results-message');
        if (noResultsMessage) {
          noResultsMessage.remove();
        }
      }
      
      // Fun√ß√£o para carregar categorias do banco de dados
      function loadCategoriesFromDatabase() {
        // Simula√ß√£o de dados do banco de dados
        // Em uma implementa√ß√£o real, voc√™ faria uma requisi√ß√£o para seu backend
        const categories = [
          { id: 'all', name: 'Todos' },
          { id: 'masculino', name: 'Masculino' },
          { id: 'feminino', name: 'Feminino' },
          { id: 'infantil', name: 'Infantil' },
          { id: 'ofertas', name: 'Ofertas' }
        ];
        
        // Atualizar filtros de categoria
        const categoriesContainer = document.getElementById('categories-container');
        categoriesContainer.innerHTML = '';
        
        categories.forEach(category => {
          const button = document.createElement('button');
          button.className = 'category-btn';
          if (category.id === 'all') button.classList.add('active');
          button.setAttribute('data-category', category.id);
          button.textContent = category.name;
          
          button.addEventListener('click', function() {
            // Remover classe active de todos os bot√µes
            document.querySelectorAll('.category-btn').forEach(btn => {
              btn.classList.remove('active');
            });
            
            // Adicionar classe active ao bot√£o clicado
            this.classList.add('active');
            
            // Filtrar produtos por categoria
            filterProductsByCategory(category.id);
          });
          
          categoriesContainer.appendChild(button);
        });
        
        // Atualizar categorias no footer
        const footerCategories = document.getElementById('footer-categories');
        footerCategories.innerHTML = '';
        
        categories.forEach(category => {
          if (category.id !== 'all') {
            const listItem = document.createElement('li');
            const link = document.createElement('a');
            link.href = `#${category.id}`;
            link.textContent = category.name;
            link.addEventListener('click', function(e) {
              e.preventDefault();
              const targetElement = document.getElementById(category.id);
              if (targetElement) {
                targetElement.scrollIntoView({
                  behavior: 'smooth',
                  block: 'start'
                });
              }
            });
            listItem.appendChild(link);
            footerCategories.appendChild(listItem);
          }
        });
      }
      
      // Fun√ß√£o para filtrar produtos por categoria
      function filterProductsByCategory(category) {
        const products = document.querySelectorAll('.product-card');
        
        products.forEach(product => {
          const productCategory = product.getAttribute('data-category');
          
          if (category === 'all' || productCategory === category) {
            product.style.display = 'block';
          } else {
            product.style.display = 'none';
          }
        });
      }
      
      // Fun√ß√£o para carregar produtos do banco de dados
      function loadProductsFromDatabase() {
        // Simula√ß√£o de dados do banco de dados
        // Em uma implementa√ß√£o real, voc√™ faria uma requisi√ß√£o para seu backend
        const products = [
          { 
            id: 1, 
            name: 'Camiseta B√°sica', 
            description: 'Camiseta 100% algod√£o', 
            price: 29.99, 
            category: 'masculino',
            image: 'img/produto1.jpg'
          },
          { 
            id: 2, 
            name: 'Vestido Floral', 
            description: 'Vestido leve para o ver√£o', 
            price: 79.99, 
            category: 'feminino',
            image: 'img/produto2.jpg'
          },
          { 
            id: 3, 
            name: 'Conjunto Infantil', 
            description: 'Conjunto confort√°vel para crian√ßas', 
            price: 49.99, 
            category: 'infantil',
            image: 'img/produto3.jpg'
          },
          { 
            id: 4, 
            name: 'Jaqueta Jeans', 
            description: 'Jaqueta jeans masculina', 
            price: 99.99, 
            category: 'masculino',
            image: 'img/produto4.jpg'
          },
          { 
            id: 5, 
            name: 'Blusa de Tric√¥', 
            description: 'Blusa feminina de tric√¥', 
            price: 69.99, 
            category: 'feminino',
            image: 'img/produto5.jpg'
          },
          { 
            id: 6, 
            name: 'T√™nis Infantil', 
            description: 'T√™nis confort√°vel para crian√ßas', 
            price: 59.99, 
            category: 'infantil',
            image: 'img/produto6.jpg'
          }
        ];
        
        // Atualizar grid de produtos
        const productsGrid = document.getElementById('products-grid');
        const loading = document.getElementById('loading');
        
        // Esconder loading
        loading.style.display = 'none';
        
        // Limpar grid
        productsGrid.innerHTML = '';
        
        // Adicionar produtos ao grid
        products.forEach(product => {
          const productCard = document.createElement('div');
          productCard.className = 'product-card';
          productCard.setAttribute('data-category', product.category);
          
          productCard.innerHTML = `
            <img src="${product.image}" alt="${product.name}" class="product-image">
            <div class="product-info">
              <h3 class="product-name">${product.name}</h3>
              <p class="product-description">${product.description}</p>
              <div class="product-price">R$ ${product.price.toFixed(2)}</div>
              <button class="btn add-to-cart" data-product-id="${product.id}">Adicionar ao Carrinho</button>
            </div>
          `;
          
          productsGrid.appendChild(productCard);
        });
        
        // Adicionar event listeners para os bot√µes "Adicionar ao Carrinho"
        document.querySelectorAll('.add-to-cart').forEach(button => {
          button.addEventListener('click', function() {
            const productId = parseInt(this.getAttribute('data-product-id'));
            const product = products.find(p => p.id === productId);
            if (product) {
              addToCart(product);
            }
          });
        });
        
        // Criar se√ß√µes para cada categoria
        createCategorySections(products);
      }
      
      // Fun√ß√£o para criar se√ß√µes para cada categoria
      function createCategorySections(products) {
        const mainElement = document.querySelector('main');
        
        // Criar se√ß√£o para Masculino
        const masculinoSection = document.createElement('section');
        masculinoSection.id = 'masculino';
        masculinoSection.className = 'category-section';
        masculinoSection.innerHTML = `
          <h2>Masculino</h2>
          <div class="products-grid" id="masculino-grid"></div>
        `;
        mainElement.appendChild(masculinoSection);
        
        // Criar se√ß√£o para Feminino
        const femininoSection = document.createElement('section');
        femininoSection.id = 'feminino';
        femininoSection.className = 'category-section';
        femininoSection.innerHTML = `
          <h2>Feminino</h2>
          <div class="products-grid" id="feminino-grid"></div>
        `;
        mainElement.appendChild(femininoSection);
        
        // Criar se√ß√£o para Infantil
        const infantilSection = document.createElement('section');
        infantilSection.id = 'infantil';
        infantilSection.className = 'category-section';
        infantilSection.innerHTML = `
          <h2>Infantil</h2>
          <div class="products-grid" id="infantil-grid"></div>
        `;
        mainElement.appendChild(infantilSection);
        
        // Criar se√ß√£o para Ofertas
        const ofertasSection = document.createElement('section');
        ofertasSection.id = 'ofertas';
        ofertasSection.className = 'category-section';
        ofertasSection.innerHTML = `
          <h2>Ofertas</h2>
          <div class="products-grid" id="ofertas-grid"></div>
        `;
        mainElement.appendChild(ofertasSection);
        
        // Preencher cada se√ß√£o com os produtos correspondentes
        fillCategorySection('masculino', products);
        fillCategorySection('feminino', products);
        fillCategorySection('infantil', products);
        fillCategorySection('ofertas', products);
      }
      
      // Fun√ß√£o para preencher uma se√ß√£o de categoria com produtos
      function fillCategorySection(category, products) {
        const sectionGrid = document.getElementById(`${category}-grid`);
        const categoryProducts = products.filter(product => product.category === category);
        
        categoryProducts.forEach(product => {
          const productCard = document.createElement('div');
          productCard.className = 'product-card';
          
          productCard.innerHTML = `
            <img src="${product.image}" alt="${product.name}" class="product-image">
            <div class="product-info">
              <h3 class="product-name">${product.name}</h3>
              <p class="product-description">${product.description}</p>
              <div class="product-price">R$ ${product.price.toFixed(2)}</div>
              <button class="btn add-to-cart" data-product-id="${product.id}">Adicionar ao Carrinho</button>
            </div>
          `;
          
          sectionGrid.appendChild(productCard);
        });
        
        // Adicionar event listeners para os bot√µes "Adicionar ao Carrinho" nas se√ß√µes
        sectionGrid.querySelectorAll('.add-to-cart').forEach(button => {
          button.addEventListener('click', function() {
            const productId = parseInt(this.getAttribute('data-product-id'));
            const product = products.find(p => p.id === productId);
            if (product) {
              addToCart(product);
            }
          });
        });
      }
    </script>

    <style>
      /* Menu Mobile */
      .mobile-menu-toggle {
        display: none;
        flex-direction: column;
        background: none;
        border: none;
        cursor: pointer;
        padding: 5px;
        width: 30px;
        height: 30px;
        justify-content: space-between;
        align-items: center;
      }

      .mobile-menu-toggle span {
        display: block;
        width: 100%;
        height: 3px;
        background: var(--text);
        border-radius: 2px;
        transition: var(--transition);
        transform-origin: center;
      }

      .mobile-menu-toggle.active span:nth-child(1) {
        transform: rotate(45deg) translate(6px, 6px);
      }

      .mobile-menu-toggle.active span:nth-child(2) {
        opacity: 0;
      }

      .mobile-menu-toggle.active span:nth-child(3) {
        transform: rotate(-45deg) translate(6px, -6px);
      }

      /* Navega√ß√£o Principal */
      .main-nav ul {
        display: flex;
        list-style: none;
        gap: 25px;
        margin: 0;
        padding: 0;
      }

      .main-nav ul li a {
        color: var(--text);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
        padding: 8px 0;
        position: relative;
        font-size: 0.9rem;
        white-space: nowrap;
      }

      .main-nav ul li a::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--secondary);
        transition: var(--transition);
      }

      .main-nav ul li a:hover {
        color: var(--secondary);
      }

      .main-nav ul li a:hover::after {
        width: 100%;
      }

      /* Header Content */
      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 20px;
        position: relative;
      }

      /* Estilos para as se√ß√µes de categoria */
      .category-section {
        margin: 60px 0;
        padding: 40px 0;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .category-section h2 {
        margin-bottom: 30px;
        font-size: 2rem;
        text-align: center;
      }

      /* Estilo para mensagem de nenhum resultado */
      .no-results {
        text-align: center;
        padding: 40px;
        font-size: 1.2rem;
        color: #999;
        grid-column: 1 / -1;
      }

      /* Responsividade */
      @media (max-width: 1024px) {
        .main-nav ul {
          gap: 20px;
        }
      }

      @media (max-width: 768px) {
        .mobile-menu-toggle {
          display: flex;
        }

        .main-nav {
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          background: var(--card-bg);
          border-top: 1px solid rgba(255, 255, 255, 0.1);
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
          transform: translateY(-10px);
          opacity: 0;
          visibility: hidden;
          transition: all 0.3s ease;
          z-index: 999;
        }

        .main-nav.active {
          transform: translateY(0);
          opacity: 1;
          visibility: visible;
        }

        .main-nav ul {
          flex-direction: column;
          gap: 0;
          padding: 15px 0;
        }

        .main-nav ul li {
          width: 100%;
        }

        .main-nav ul li a {
          display: block;
          padding: 12px 20px;
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
          font-size: 1rem;
        }

        .main-nav ul li a::after {
          display: none;
        }

        .main-nav ul li:last-child a {
          border-bottom: none;
        }

        .main-nav ul li a:hover {
          background: rgba(255, 255, 255, 0.05);
          color: var(--secondary);
        }

        .header-content {
          flex-wrap: wrap;
        }

        .search-cart {
          order: 3;
          width: 100%;
          justify-content: center;
          margin-top: 15px;
          display: none;
        }

        .main-nav.active + .search-cart {
          display: flex;
        }
      }

      @media (max-width: 480px) {
        .logo {
          font-size: 1.4rem;
        }

        .search-cart {
          gap: 10px;
        }

        .search-box input {
          width: 150px;
        }

        .user-greeting {
          font-size: 0.8rem;
        }
      }

      /* Ajustes para quando o menu est√° aberto no mobile */
      @media (max-width: 768px) {
        body.menu-open {
          overflow: hidden;
        }

        .main-nav.active {
          max-height: 70vh;
          overflow-y: auto;
        }
      }
    </style>
  </body>
</html>
